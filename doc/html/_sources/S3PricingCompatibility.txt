#summary Interplay with Amazon's S3 Pricing

= Interplay with Amazon's S3 Pricing =

The pricing for Amazon S3 has three elements: storage, data transfer and requests (see [http://aws.amazon.com/s3/#pricing current S3 prices] on the Amazon Webpage for actual numbers). This page explains how to estimate the price for using a bucket to store an S3QL file system.

<wiki:toc max_depth="2" />

== Storage Costs ==

The price for S3 storage is determined by the amount of data that you store in your file system. S3QL introduces very little overhead, so the size of your file system (after compression and de-duplication) will correspond to the size of the S3 bucket to within a few megabytes. 

In other words, if your file system size is _n_ GB after de-duplication and compression, you will have to pay for _n_ GB data storage in S3.


== Data Transfer Costs ==

The price for data transfer to S3 depends on the size and number of s3 objects that you read and write. The smaller you choose S3QL's block size, the less you will have to pay for data transfer. (If you have a blocksize of 10 MB, and you want to read a couple of bytes from the beginning of a 40 MB file, you still have to retrieve the entire first block of 10 MB from S3. If your blocksize is only 5 MB, you will have to retrieve only half as much.). 

Note that if most of your filesystem operations are just writing and/or reading entire files (e.g. because you are using S3QL only to store backups), the blocksize can be set to a relatively high value without any negative effects (because the whole file is going to be transferred anyway).

That said, you can roughly estimate that writing or reading _n_  MB will result in data transfer costs for _n_ MB. The actual costs will probably be much lower due to compression and de-duplication.

== Requests ==

In addition to the fee for data transfer, Amazon charges a fixed amount for each individual request that is made to S3, no matter how large or small the request. For large requests, the request fee is therefore negligible compared to the price for data transfer. For small requests however, this fee becomes more and more important.

Almost all requests that S3QL sends to S3 are for storing or retrieving file contents. You can thus reduce the number of S3 requests by choosing a larger blocksize, but you should keep in mind that increasing the blocksize may also result in a lot of useless data being transferred (as explained above).

A rough formula to determine the cost is to divide the amount of data to be read or written by the blocksize. So if you read/write _n_ MB of data, you will have to pay for _n_/_blocksize_ requests.

All requests will be GET or PUT. A LIST request is only generated when running `fsck.s3ql` or `stat.s3ql`.