.. -*- mode: rst -*-


Managing Buckets
=====================


The `s3qladm` command performs various operations on S3QL buckets.
The file system contained in the bucket *must not be mounted* when
using `s3qladm` or things will go wrong badly.

The syntax is ::

 s3qladm [options] <action> <storage-url>

For a list of valid options, run `s3qladm --help`. The available
actions are explained in the following subsections.


Changing the Passphrase
-----------------------

To change the passphrase a bucket, use the `s3qladm` command::

  s3qladm passphrase  <storage url>

The passphrase can only be changed when the bucket is not mounted.

Upgrading the file system
-------------------------

If you have installed a new version of S3QL, is usually necessary to
upgrade your file system metadata. Note that afterwards the file system
can no longer be accessed with older versions of S3QL.

Before you upgrade the file system, you should run `fsck.s3ql` (from
the S3QL release that you are upgrading from).

During the upgrade you have to make very sure that the command is not
interrupted, and that no one else tries to mount, fsck or upgrade the
file system at the same time.

Finally, note that `s3qladm` can only upgrade from the *previous*
S3QL release, so you cannot directly upgrade e.g. from version 0.10 to
version 0.12. You first have to download S3QL 0.11 and upgrade the
file system from 0.10 to 0.11 before you can install S3QL 0.12 and
upgrade the file system from 0.11 to 0.12.

To upgrade a file system from the previous to the current revision,
execute ::

  s3qladm upgrade <storage url>


Deleting a file system
----------------------

A file system can be deleted with::

  s3qladm delete <storage url>

This physically deletes all the data and file system structures.
